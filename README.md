# LanguageSwitcher (на базе AutoHotkey v2)

Скрипт для быстрой правки текста, набранного «не в той раскладке», **с автоматическим переключением языка ввода**. 
Легкая замена глючного на сегондяшний день Punto Switcher.
Работает в любых полях ввода, где доступны стандартные сочетания `Ctrl+C` / `Ctrl+V`.

---

## Что делает

- Определяет, какими буквами набран выделенный фрагмент:
  - есть русские буквы → считает, что текст набран в RU и конвертирует в EN;
  - есть английские буквы → считает, что текст набран в EN и конвертирует в RU.
- Пересобирает строку **по раскладке клавиатуры**, а не переводит по смыслу:
  - `ghbdtn` → `привет`
  - `руддщ` → `hello`
- **Автоматически переключает раскладку ввода** после успешной конвертации  
  (эмулирует `Alt+Shift`), чтобы текущий язык совпадал с исправленным текстом.
- Аккуратно работает с буфером обмена:
  - временно использует `Ctrl+C` / `Ctrl+V` для обработки;
  - через небольшой таймер возвращает в буфер обмена то, что было до операции.
- Может сам выделять нужный фрагмент (от курсора до начала строки или предыдущее слово).
- Висит в трее.

---

## Горячие клавиши

### `Break`

Написал строку, понял, что набирал не в той раскладке.

Что делает:

1. Выделяет текст от курсора **до начала строки** (`Shift+Home`).
2. Копирует его (`Ctrl+C`).
3. Конвертирует раскладку RU ↔ EN.
4. Вставляет исправленный текст обратно (`Ctrl+V`).
5. Нажимает `Alt+Shift`, чтобы **переключить язык ввода** под исправленный текст.
6. Через короткое время возвращает в буфер обмена исходное содержимое.

---

### `Shift + Break`

Уже выделил нужный фрагмент мышкой или клавиатурой и хочешь исправить **только его**.

Что делает:

1. Берёт **текущее выделение** как есть (без дополнительных выделений).
2. Копирует его (`Ctrl+C`).
3. Конвертирует раскладку RU ↔ EN.
4. Вставляет исправленный текст обратно (`Ctrl+V`).
5. Нажимает `Alt+Shift`, чтобы **переключить язык ввода** под исправленный текст.
6. Восстанавливает исходное содержимое буфера обмена.

---

### `Ctrl + Break`

Печатаешь текст, промахнулся с раскладкой на **последнем слове**.

Что делает:

1. Выделяет слово слева от курсора (`Ctrl+Shift+Left`).
2. Копирует его (`Ctrl+C`).
3. Конвертирует раскладку RU ↔ EN.
4. Вставляет исправленное слово обратно (`Ctrl+V`).
5. Нажимает `Alt+Shift`, чтобы **переключить язык ввода** под исправленный текст.
6. Возвращает в буфер обмена то, что было до операции.

---

## Кратко по сценариям

- `Break` — исправить **всю строку от начала до курсора** и сразу продолжить печатать на правильном языке.
- `Shift + Break` — исправить **то, что уже выделил**, без автодобора текста.
- `Ctrl + Break` — исправить **последнее слово** и сразу продолжить на правильной раскладке.

---

## Требования

- Windows

## Использование
- Скачать Language Switcher.exe (или Language Switcher_Main.ahk и LanguageSwitcher_UI.ahk, если хотите лично конвертировать файлы в exe)
- Запустить Language Switcher.exe
